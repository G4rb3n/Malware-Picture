## Z0Miner

2021-3-26

腾讯安全威胁情报中心曾在去年12月披露z0miner挖矿木马团伙利用Weblogic未授权命令执行漏洞（CVE-2020-14882/14883）攻击了约5000台服务器，近期观察到该团伙使用的漏洞武器已经升级为多种漏洞工具并用。

进程：
/tmp/.solr/solrd

文件：
/tmp/.solr/config.json
/tmp/.solr/solrd
/tmp/.solr/solr.sh

计划任务：
包含pastbin的可疑恶意载荷任务。


加固以下服务器组件：
修改Nexus3内置默认帐号密码admin:admin123。
将Nexus3，Confluence，Weblogic，Struts2升级到最新版本，对Jenkins添加认证且设置强密码。

分析腾讯云防火墙拦截到z0miner挖矿木马利用漏洞攻击的payload代码，发现该团伙新增5种漏洞攻击能力：Nexus3 命令执行漏洞（CVE-2019-7238）、Confluence未授权模版注入/代码执行漏洞（CVE-2019-3396）、Weblogic未授权命令执行漏洞(CVE-2020-14882)、Jenkins未授权命令执行漏洞、Struts2命令执行漏洞 （s2-016，s2-046）。


漏洞攻击得手后会下载不同的恶意脚本执行，会结束竞品挖矿木马进程，删除竞品挖矿木马文件，并尝试添加计划任务（当前捕获的版本载荷为空）。最后下载门罗币挖矿模块进行挖矿计算。查看该团伙当前使用的钱包，发现已获得26.9个门罗币，市值约￥4万元。

![Z0Miner原理图](https://github.com/G4rb3n/Malware-Picture/blob/master/Miner/Z0Miner/z0miner.png)

参考链接
```
https://s.tencent.com/research/report/1283.html
```