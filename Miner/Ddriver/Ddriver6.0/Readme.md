2020-2-18
![Ddriver6.0图](https://github.com/G4rb3n/Malware-Picture/blob/master/Miner/Ddriver/Ddriver6.0/Ddriver6.0.png)

```
入侵途径：

  通过漏洞、Hash窃取等方式远程执行ps命令 --> 从C&C服务器下载核心的ps攻击代码 --> 根据不同系统下载相应的挖矿模块进行挖矿 --> 如果是N卡的额外下载特定的挖矿模块进行挖矿 -> 通过漏洞、Hash窃取的方式进行传播 --> 修改DNS地址 --> 开启65529/TCP端口标识避免重复感染


入侵点
  ｜
  ｜--> 永恒之蓝漏洞传播
  ｜--> IPC弱口令爆破传播
  ｜--> MSSQL弱口令爆破传播
  ｜--> RDP弱口令爆破传播
  ｜--> Hash传递传播
  ｜--> 结合LNK漏洞通过USB和网络驱动器传播

攻击组件
  ｜
  ｜--> 传播模块
  ｜      ｜
  ｜      ｜--> if.bin -- ps脚本 -- efa8eb64099989f2699eff82a7ff35dc750c027e
  ｜
  ｜--> 挖矿模块
  ｜      ｜
  ｜      ｜--> me3.exe -- 32挖矿程序 -- 0C4DB17ED145310F336AB4887914F80C 
  ｜      ｜--> m6.bin -- 64挖矿程序 -- 0a9dda0c221215415314269497bd4801a6a0f8c2
  ｜      ｜--> m6g.exe -- N卡挖矿程序 -- 3204ece6d1aec56aaf540c1e1da1225f0bf60e50
  ｜
  ｜--> 灰色工具
          ｜
          ｜--> powershell

漏洞
 ｜
 ｜--> MS17-010 -- SMB远程执行命令漏洞
 ｜--> CVE-2019-0708 -- RDP远程执行命令漏洞
 ｜--> CVE-2017-8464 -- LNK远程执行代码漏洞

绕过防御
   ｜
   ｜--> 将矿机程序注入到Powershell进程进行挖矿
   ｜--> 通过修改hosts文件，将生成的DGA域名映射到其控制的服务器IP地址，绕过安全网关

横向渗透
   ｜
   ｜--> 永恒之蓝漏洞传播
   ｜--> IPC弱口令爆破传播
   ｜--> MSSQL弱口令爆破传播
   ｜--> RDP弱口令爆破传播
   ｜--> Hash传递传播

持久化
  ｜
  ｜--> 随机名任务计划 -- powershell核心恶意代码
  ｜--> Rtsa1 -- powershell篡改DNS代码
  ｜--> Rtsa2 -- powershell下载器

C&C通信
   ｜
   ｜--> t.awcna.com
   ｜--> t.tr2q.com
   ｜--> t.amxny.com
   ｜--> 27.102.114.207


目的
 ｜
 ｜--> 挖矿
 ｜--> 禁用135/445端口，导致文件共享无法使用
 ｜--> 修改 DNS 服务器地址为"8.8.8.8"及"9.9.9.9"，导致主机可能无法上网
```
