![Fox_Kitten攻击流程图](https://github.com/G4rb3n/Malware-Picture/blob/master/APT/Fox_Kitten/Fox_Kitten.png)

```
入侵途径：

  通过漏洞在目标公司的PC上执行命令 --> 分段下载一个hex格式的txt后门并执行 --> 提权升至system权限 --> 使用工具窃取管理员密码 --> 内网扫描目标IP和端口 --> 使用Hash传递的方式在服务器上远程执行命令 --> 在服务器上安装后门及Webshell --> 使用基于SSH隧道的RDP连接控住服务器 --> 窃密上传机密数据

入侵点
  ｜
  ｜--> VPN工具Pulse Secure Connect任意文件读取漏洞
  ｜--> Fortinet系统FortiOS任意文件下载漏洞
  ｜--> BYOD应用Citrix被漏洞利用
  ｜--> PAN应用Global Protect远程命令执行漏洞

攻击组件
  ｜
  ｜-->定制工具
  ｜      ｜
  ｜      ｜--> STSRCheck -- 数据库及端口映射组件 -- 364F57928FC5FB0019B73F3FBD57F99B
  ｜      ｜--> POWSSHNET -- 后门组件，使用ssh、rdp通信
  ｜      ｜--> VBScript -- 下载器，从C&C服务器下载伪装成txt文件的可执行文件 -- 3741f987c9bd14263ffb4824dce8c147
  ｜      ｜--> Socket-based backdoor over cs.exe -- 用于开启端口的exe组件
  ｜      ｜--> 外网webshell
  ｜      ｜--> 内网webshell -- IIS服务器
  ｜      ｜--> Combine.bat -- payload下载器 -- ac9993f1124d404a08531df9a0ae28c9
  ｜
  ｜-->开源工具
  ｜      ｜
  ｜      ｜--> Invoke the Hash -- 用于哈希传递登陆的ps脚本 -- 0C4DB17ED145310F336AB4887914F80C 
  ｜      ｜--> JuicyPotato -- 本地提权工具
  ｜      ｜--> ProcDump-- 密码窃取工具
  ｜      ｜--> Mimikatz-- 密码窃取工具
  ｜
  ｜-->灰色工具
          ｜
          ｜--> Ngrok -- 免费远控工具
          ｜--> FRP-- 免费远控工具
          ｜--> Serveo -- 免费远控工具
          ｜--> Putty -- 远程工具
          ｜--> Plink-- 远程工具

漏洞
 ｜
 ｜--> CVE-2019-11510 -- VPN工具Pulse Secure Connect任意文件读取漏洞
 ｜--> CVE-2018-13379 -- Fortinet系统FortiOS任意文件下载漏洞
 ｜--> CVE-2018-1579 -- PAN应用Global Protect远程命令执行漏洞

绕过防御
   ｜
   ｜--> 以txt的格式分段下载payload数据，最后拼接成一个exe后门
   ｜--> 使用cpuid指令检测虚拟机

横向渗透
   ｜
   ｜--> 使用Juicy Potato工具提权至SYSTEM权限
   ｜--> 使用ProcDump+Mimikatz窃取用户密码
   ｜--> 使用STSRCheck扫描内网22、23、445、3389、80、3306、1433端口
   ｜--> 使用Invoke the Hash在内网服务器上远程执行命令
   ｜--> 在服务器上安装后门及Webshell

持久化
  ｜
  ｜--> 基于SSH隧道的RDP连接

C&C通信
   ｜
   ｜--> 18.221.150.202 -- Ngrok
   ｜--> 185.32.178.176 -- Webshell
   ｜--> 93.177.75.180 -- C&C Rotten Fish
   ｜--> 95.211.104.253 -- C&C communication SOCKET


目的
 ｜
 ｜--> 窃取目标机密信息
```
